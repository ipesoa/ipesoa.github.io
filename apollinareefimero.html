<script>
// (Tu lista de palabras sigue igual, la he abreviado aquí para no ocupar espacio)
const palabras = [
"Son","nueve","y","las","he","abierto","todas","Oh","puertas","de","tu","cuerpo",
"Son","nueve","y","para","mí","se","han","vuelto","a","cerrar","todas","En","la",
"primera","puerta","La","Clara","Razón","ha","muerto","Era","te","acuerdas","el",
"primer","día","en","Niza","Tu","ojo","izquierdo","así","como","una","culebra","se",
"desliza","Hasta","mi","corazón","Y","que","se","vuelva","a","abrir","de","nuevo",
"la","puerta","de","tu","mirada","izquierda","En","la","segunda","puerta","Ha",
"muerto","toda","mi","fuerza","Era","te","acuerdas","en","un","albergue","en",
"Cagnes","Tu","ojo","derecho","palpitaba","como","mi","corazón","Tus","párpados",
"latían","como","en","la","brisa","laten","las","flores","Y","que","se","vuelva",
"a","abrir","de","nuevo","la","puerta","de","tu","mirada","derecha","En","la",
"tercera","puerta","Escucha","latir","la","aorta","Y","todas","mis","arterias",
"hinchadas","por","tu","sólo","amor","Y","que","se","vuelva","a","abrir","de",
"nuevo","la","puerta","de","tu","oído","izquierdo","En","la","cuarta","puerta",
"Me","escoltan","todas","las","primaveras","Y","aguzando","el","oído","se","escucha",
"del","bonito","bosque","Subir","esta","canción","de","amor","y","de","los","nidos",
"Tan","triste","para","los","soldados","que","están","en","la","guerra","Y","que",
"se","vuelva","a","abrir","de","nuevo","la","puerta","de","tu","oído","derecho",
"Que","no","sea","en","el","desordenado","sufrir","De","turbias","y","sombrías",
"moradas","Subamos","juntos","la","escalera","empinada","Observatorio","de","la",
"naturaleza","Contemplando","del","valle","su","delicadeza","Sus","floridas",
"laderas","Su","río","cristalino","corriendo","Permitid","que","vigile","soñoliento",
"Bajo","el","tejado","de","verdes","ramas","Donde","los","ciervos","pasan","como",
"ráfajas","Agitando","a","las","abejas","en","sus","campanas","Pero","aunque",
"con","placer","imagino","Estas","dulces","escenas","contigo","El","suave",
"conversar","de","una","mente","Cuyas","palabras","son","imágenes","inocentes",
"Es","el","placer","de","mi","alma","y","sin","duda","debe","ser","El","mayor",
"gozo","de","la","humanidad","Soñar","que","tu","raza","pueda","sufrir","Por",
"dos","espíritus","que","juntos","deciden","huir","Una","cosa","bella","es","un",
"goce","eterno","Su","hermosura","va","creciendo","Y","jamás","caerá","en","la",
"nada","Antes","conservará","para","nosotros","Un","plácido","retiro","Un","sueño",
"lleno","de","dulces","sueños","La","salud","un","relajado","alentar","Así","cada",
"mañana","trenzamos","una","Guirnalda","de","flores","que","nos","ata","a","la",
"tierra","A","pesar","del","desaliento","a","la","inhumana","Falta","de",
"naturalezas","nobles","A","los","días","nublados","A","todos","los","caminos",
"insanos","y","lóbregos","Abiertos","a","nuestra","búsqueda","Si","pese","a",
"todo","alguna","bella","forma","Alza","el","paño","mortuorio","De","nuestro",
"espíritu","ensombrecido","Como","el","sol","la","luna","los","árboles","ancianos",
"y","los","nuevos","Tendiendo","su","sombra","cálida","sobre","los","rebaños",
"Como","también","los","narcisos","Y","el","universo","verde","en","el","que",
"moran","Y","los","claros","arroyos","que","fluyendo","Frescos","hacia","el",
"estío","Y","el","claro","en","medio","del","bosque","Manchado","de","rosas",
"silvestres","Y","así","el","sublime","destino","Que","imaginamos","para","los",
"grandes","muertos","Todos","los","deliciosos","cuentos","que","oímos","o",
"leímos","Fuente","eterna","de","una","linfa","inmortal","Que","cae","sobre",
"nosotros","desde","la","orilla","del","cielo","Los","momentos","pasaban","como",
"en","el","teatro","tenía","la","sabiduría","que","el","amor","hace","nacer",
"tenía","mi","cuota","de","sentido","común","y","a","pesar","de","todo","cuanto",
"podría","afirmar","y","aunque","tenía","por","eso","el","elogio","de","ella",
"una","nube","venida","desde","el","norte","despiadado","ocultó","de","repente",
"la","luna","del","Amor","Creyendo","cada","palabra","que","decía","yo","alabé",
"su","espíritu","y","su","cuerpo","hasta","que","el","orgullo","hizo","brillar",
"sus","ojos","y","sonrojó","sus","mejillas","el","placer","y","volvió","ligeros",
"sus","pasos","la","vanidad","nosotros","sin","embargo","a","pesar","de","esos",
"elogios","en","lo","alto","veíamos","tan","sólo","oscuridad","Nos","sentamos",
"silenciosos","como","piedras","sabíamos","aunque","ella","no","hubiera","dicho",
"una","palabra","que","aún","el","mejor","amor","debe","morir","y","se","habría",
"destruido","en","forma","cruel","de","no","ser","porque","el","Amor","ante",
"el","grito","de","un","grotesco","pajarillo","arrancó","de","las","nubes","su",
"luna","maravillosa","Qué","haré","con","esto","que","es","absurdo","oh",
"corazón","turbado","corazón","esta","caricatura","esta","edad","decrépita","que",
"me","ha","atado","como","un","palo","a","la","cola","de","un","perro","Nunca",
"tuve","más","viva","apasionada","fantástica","imaginación","que","ahora","ni",
"sentidos","capaces","de","aceptar","lo","imposible","ni","siquiera","en","la",
"infancia","cuando","con","caña","y","mosca","o","con","el","humilde","gusano",
"trepaba","las","laderas","del","Ben","Bulben","con","un","día","eterno","de",
"verano","por","delante","Parece","que","ahora","debo","despedir","a","la","Musa",
"cultivar","la","amistad","de","Platón","y","Plotino","hasta","que","la",
"imaginación","y","los","sentidos","puedan","hallar","contento","en","el","debate",
"convivir","con","abstracciones","o","bien","sufrir","la","burla","de","un",
"abollado","caldero","en","los","tobillos","En","aquel","tiempo","yo","tenía",
"veinte","años","y","estaba","loco","Había","perdido","un","país","pero","había",
"ganado","un","sueño","Y","si","tenía","ese","sueño","lo","demás","no","importaba",
"Ni","trabajar","ni","rezar","ni","estudiar","en","la","madrugada","junto","a",
"los","perros","románticos","Y","el","sueño","vivía","en","el","vacío","de","mi",
"espíritu","Una","habitación","de","madera","en","penumbras","en","uno","de","los",
"pulmones","del","trópico","Y","a","veces","me","volvía","dentro","de","mí","y",
"visitaba","el","sueño","estatua","eternizada","en","pensamientos","líquidos","un",
"gusano","blanco","retorciéndose","en","el","amor","Un","amor","desbocado","Un",
"sueño","dentro","de","otro","sueño","Y","la","pesadilla","me","decía","crecerás",
"Dejarás","atrás","las","imágenes","del","dolor","y","del","laberinto","y",
"olvidarás","Pero","en","aquel","tiempo","crecer","hubiera","sido","un","crimen",
"Estoy","aquí","dije","con","los","perros","románticos","y","aquí","me","voy",
"a","quedar","Este","poema","publicado","en","el","libro","del","mismo","nombre",
"nos","habla","de","la","juventud","y","de","la","locura","y","el","descontrol",
"de","las","pasiones","con","las","que","se","suele","asociar"
];

function random(arr) {
    return arr[Math.floor(Math.random() * arr.length)];
}

function generarPoema() {
    const area = document.getElementById("poema-area");
    area.innerHTML = "";

    // CONFIGURACIÓN
    const totalPalabras = 25;   // Cuantas palabras quieres
    const padding = 5;          // Espacio mínimo entre palabras (px)
    const maxIntentos = 100;    // Cuantas veces intenta colocarla antes de rendirse

    // Aquí guardaremos las posiciones de las palabras ya colocadas
    // Formato: { left, right, top, bottom }
    const ocupado = [];

    const areaW = area.clientWidth;
    const areaH = area.clientHeight;

    for (let i = 0; i < totalPalabras; i++) {
        // 1. Crear elemento y medirlo
        const w = document.createElement("div");
        w.className = "word";
        w.innerText = random(palabras);
        
        // Lo hacemos invisible temporalmente para poder medir su ancho/alto
        w.style.opacity = "0"; 
        area.appendChild(w);

        const anchoW = w.offsetWidth;
        const altoW = w.offsetHeight;

        // 2. Intentar colocarlo sin chocar
        let colocado = false;

        for (let attempt = 0; attempt < maxIntentos; attempt++) {
            // Posición aleatoria dentro del contenedor
            const x = Math.floor(Math.random() * (areaW - anchoW));
            const y = Math.floor(Math.random() * (areaH - altoW));

            // Definir la caja de la nueva palabra
            const candidato = {
                left: x,
                right: x + anchoW,
                top: y,
                bottom: y + altoW
            };

            // 3. Comprobar colisión con TODAS las anteriores
            let choca = false;
            for (let caja of ocupado) {
                // Lógica de superposición de rectángulos + padding
                if (!(candidato.right + padding < caja.left || 
                      candidato.left > caja.right + padding || 
                      candidato.bottom + padding < caja.top || 
                      candidato.top > caja.bottom + padding)) {
                    choca = true;
                    break;
                }
            }

            // 4. Si no choca, guardamos y mostramos
            if (!choca) {
                w.style.left = x + "px";
                w.style.top = y + "px";
                w.style.opacity = "1"; // Ya la hacemos visible
                
                ocupado.push(candidato);
                colocado = true;
                break; // Salimos del bucle de intentos
            }
        }

        // Si después de 100 intentos no cabe, la eliminamos del DOM
        if (!colocado) {
            w.remove();
        }
    }
}

// Generar al cargar la página
window.onload = generarPoema;
</script>
